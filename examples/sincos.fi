
;==============================================================================
; simple routines for calculating sin/cos, based on a table
;==============================================================================

;returns signed value from -32767 to 32767

function cos(calc_value)    ;value=0 to 1023 (0=0ø 1024=360ø)
    {
    calc_value=calc_value and 1023
    sign=0

    if calc_value>=768 then calc_value=1023-calc_value
    else if calc_value>=512 then calc_value-=512:sign=1
    else if calc_value>=256 then calc_value=511-calc_value:sign=1

    calc_value=peek (cos_table+calc_value*2)

    if sign then return 0-calc_value
    return calc_value

    cos_table:			    ;table = cos (0-90ø)
    data 32767,32766,32764,32761
    data 32757,32751,32744,32736
    data 32727,32716,32704,32691
    data 32677,32661,32645,32627
    data 32607,32587,32565,32542
    data 32518,32493,32466,32438
    data 32409,32379,32347,32314
    data 32280,32245,32209,32171
    data 32132,32092,32050,32008
    data 31964,31919,31873,31825
    data 31777,31727,31676,31624
    data 31570,31516,31460,31403
    data 31345,31285,31225,31163
    data 31100,31036,30970,30904
    data 30836,30767,30697,30626
    data 30554,30480,30406,30330
    data 30253,30175,30096,30015
    data 29934,29851,29767,29682
    data 29596,29509,29421,29331
    data 29241,29149,29056,28963
    data 28868,28772,28674,28576
    data 28477,28377,28275,28173
    data 28069,27964,27859,27752
    data 27644,27535,27425,27314
    data 27202,27089,26975,26860
    data 26744,26627,26509,26389
    data 26269,26148,26026,25903
    data 25779,25654,25528,25401
    data 25273,25144,25014,24883
    data 24751,24618,24485,24350
    data 24215,24078,23941,23803
    data 23663,23523,23382,23241
    data 23098,22954,22810,22664
    data 22518,22371,22223,22074
    data 21925,21774,21623,21471
    data 21318,21165,21010,20855
    data 20699,20542,20384,20226
    data 20067,19907,19746,19585
    data 19422,19259,19096,18931
    data 18766,18600,18434,18267
    data 18099,17930,17761,17591
    data 17420,17249,17077,16905
    data 16731,16557,16383,16208
    data 16032,15856,15679,15501
    data 15323,15145,14965,14785
    data 14605,14424,14243,14060
    data 13878,13695,13511,13327
    data 13142,12957,12772,12585
    data 12399,12212,12024,11836
    data 11648,11459,11270,11080
    data 10890,10699,10508,10317
    data 10125,9933,9740,9547
    data 9354,9161,8967,8772
    data 8578,8383,8187,7992
    data 7796,7600,7403,7206
    data 7009,6812,6615,6417
    data 6219,6020,5822,5623
    data 5424,5225,5026,4826
    data 4626,4426,4226,4026
    data 3826,3625,3425,3224
    data 3023,2822,2621,2419
    data 2218,2017,1815,1614
    data 1412,1210,1009,807
    data 605,403,201,0
    }

function sin(calc_value)    ;value=0 to 1023 (0=0ø 1024=360ø)
    {
    return cos(calc_value-256)
    }
